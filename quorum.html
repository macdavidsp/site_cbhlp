<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Quórum</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Quórum da Reunião</h1>
    <nav>
      <ul>
        <li><a href="index.html">Início</a></li>
        <li><a href="cadastro.html">Registro</a></li>
        <li><a href="verificar.html">Verificação</a></li>
        <li><a href="quorum.html">Quórum</a></li>
        <li><a href="admin.html">Admin</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <button onclick="calcularQuorum()">Calcular Quórum</button>
    <ul id="resultadoQuorum"></ul>
  </main>

  <script>
    async function calcularQuorum() {
      const res = await fetch("https://script.google.com/macros/s/AKfycbxlxiuVdashA7ScizB1NuTzIYhVpDu-dkB4GBEnY6lQxiaqQy7IwD_f756KwoOGKkG_/exec");
      const dados = await res.json();
      const presencas = dados.slice(1); // ignora cabeçalho

      const setores = {};
      presencas.forEach(p => {
        const setor = p[4];
        setores[setor] = (setores[setor] || 0) + 1;
      });

      const lista = document.getElementById("resultadoQuorum");
      lista.innerHTML = Object.entries(setores)
        .map(([setor, total]) => `<li>${setor}: ${total} presentes</li>`)
        .join("");
    }
  </script>
</body>
</html>